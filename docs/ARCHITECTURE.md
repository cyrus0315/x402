# ğŸ—ï¸ PayPerInsight æ¶æ„æ–‡æ¡£

> å»ä¸­å¿ƒåŒ– AI çŸ¥è¯†ä»˜è´¹å³æ—¶å¸‚åœº - åŸºäº x402 åè®® + Monad

---

## ğŸ“Š ç³»ç»Ÿæ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ç”¨æˆ·æµè§ˆå™¨                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     React å‰ç«¯ (localhost:5173)                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚   â”‚
â”‚  â”‚  â”‚  é¦–é¡µ    â”‚  â”‚ å†…å®¹è¯¦æƒ…  â”‚  â”‚  åˆ›å»º   â”‚  â”‚ ä¸ªäººä¸­å¿ƒ  â”‚            â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   â”‚
â”‚  â”‚                         â”‚                                           â”‚   â”‚
â”‚  â”‚                         â–¼                                           â”‚   â”‚
â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚   â”‚
â”‚  â”‚              â”‚   MetaMask é’±åŒ…     â”‚                                â”‚   â”‚
â”‚  â”‚              â”‚  (x402 æ”¯ä»˜ç­¾å)    â”‚                                â”‚   â”‚
â”‚  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚               â”‚               â”‚
                    â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   NestJS åç«¯        â”‚  â”‚ Thirdweb x402   â”‚  â”‚   Monad Blockchain      â”‚
â”‚   (localhost:3001)   â”‚  â”‚   Facilitator   â”‚  â”‚   (Chain ID: 10143)     â”‚
â”‚                      â”‚â—„â”€â”¤                 â”œâ”€â–ºâ”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  - æ”¯ä»˜éªŒè¯     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Content Module â”‚  â”‚  â”‚  - ç»“ç®—äº¤æ˜“     â”‚  â”‚  â”‚ PayPerInsight.sol â”‚  â”‚
â”‚  â”‚ Payment Module â”‚  â”‚  â”‚                 â”‚  â”‚  â”‚                   â”‚  â”‚
â”‚  â”‚ User Module    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  - å†…å®¹æ³¨å†Œ       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                       â”‚  â”‚  - NFT é“¸é€        â”‚  â”‚
â”‚                      â”‚                       â”‚  â”‚  - æ”¶ç›Šåˆ†é…       â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|------|
| **å‰ç«¯** | React + Vite | 18.x / 5.x | SPA åº”ç”¨ |
| **æ ·å¼** | Tailwind CSS | 3.x | åŸå­åŒ– CSS |
| **åŠ¨ç”»** | Framer Motion | 10.x | æµç•…äº¤äº’åŠ¨æ•ˆ |
| **çŠ¶æ€ç®¡ç†** | Zustand | 4.x | è½»é‡çŠ¶æ€ç®¡ç† |
| **åç«¯** | NestJS | 10.x | ä¼ä¸šçº§ Node.js æ¡†æ¶ |
| **æ™ºèƒ½åˆçº¦** | Solidity | 0.8.20 | EVM æ™ºèƒ½åˆçº¦ |
| **åˆçº¦æ¡†æ¶** | Hardhat | 2.x | å¼€å‘/æµ‹è¯•/éƒ¨ç½² |
| **æ”¯ä»˜åè®®** | x402 + Thirdweb | - | HTTP 402 æ”¯ä»˜ |
| **åŒºå—é“¾** | Monad Testnet | Chain 10143 | é«˜æ€§èƒ½ L1 |

---

# ğŸ“œ æ™ºèƒ½åˆçº¦æ¶æ„

## åˆçº¦æ¦‚è§ˆ

**æ–‡ä»¶**: `contracts/contracts/PayPerInsight.sol`

**åˆçº¦åœ°å€**: *(éƒ¨ç½²åå¡«å†™)*

### ç»§æ‰¿ç»“æ„

```
PayPerInsight
    â”‚
    â”œâ”€â”€ ERC721              # NFT æ ‡å‡† (OpenZeppelin)
    â”œâ”€â”€ ERC721URIStorage    # NFT å…ƒæ•°æ®å­˜å‚¨
    â”œâ”€â”€ Ownable             # æ‰€æœ‰æƒç®¡ç†
    â””â”€â”€ ReentrancyGuard     # é˜²é‡å…¥æ”»å‡»ä¿æŠ¤
```

---

## æ ¸å¿ƒæ•°æ®ç»“æ„

### Content ç»“æ„ä½“

```solidity
struct Content {
    address creator;        // åˆ›ä½œè€…åœ°å€
    uint256 basePrice;      // åŸºç¡€ä»·æ ¼ (wei)
    string metadataURI;     // å†…å®¹å…ƒæ•°æ® URI (IPFS/HTTP)
    uint256 unlockCount;    // è§£é”æ¬¡æ•° (ç”¨äºåŠ¨æ€å®šä»·)
    uint256 createdAt;      // åˆ›å»ºæ—¶é—´æˆ³
    bool active;            // æ˜¯å¦æ¿€æ´»
}
```

### UnlockRecord ç»“æ„ä½“

```solidity
struct UnlockRecord {
    uint256 contentId;      // å†…å®¹ID
    uint256 tokenId;        // é“¸é€ çš„ NFT Token ID
    uint256 paidPrice;      // å®é™…æ”¯ä»˜ä»·æ ¼
    address referrer;       // æ¨èäººåœ°å€
    uint256 unlockedAt;     // è§£é”æ—¶é—´æˆ³
}
```

### çŠ¶æ€å˜é‡

```solidity
// å†…å®¹å­˜å‚¨
mapping(uint256 => Content) public contents;

// è§£é”çŠ¶æ€: contentId => user => hasUnlocked
mapping(uint256 => mapping(address => bool)) public hasUnlocked;

// NFT åˆ°å†…å®¹çš„æ˜ å°„: tokenId => contentId
mapping(uint256 => uint256) public tokenToContent;

// ä½™é¢è¿½è¸ª
mapping(address => uint256) public creatorBalance;    // åˆ›ä½œè€…æ”¶ç›Š
mapping(address => uint256) public referrerBalance;   // æ¨èäººæ”¶ç›Š
uint256 public platformBalance;                        // å¹³å°æ”¶ç›Š

// ç”¨æˆ·è§£é”å†å²
mapping(address => UnlockRecord[]) public userUnlocks;

// è®¡æ•°å™¨
uint256 public nextContentId = 1;
uint256 public nextTokenId = 1;
```

---

## æ”¶ç›Šåˆ†é…æœºåˆ¶

### åˆ†æˆæ¯”ä¾‹ (åŸºäº Basis Points, 10000 = 100%)

| è§’è‰² | æ¯”ä¾‹ | è¯´æ˜ |
|------|------|------|
| **åˆ›ä½œè€…** | 85% (8500 BP) | å†…å®¹åˆ›å»ºè€… |
| **æ¨èäºº** | 10% (1000 BP) | åˆ†äº«æ¨èè€… |
| **å¹³å°** | 5% (500 BP) | å¹³å°è¿è¥ |

### åˆ†é…é€»è¾‘

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·æ”¯ä»˜ (100%)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚   æœ‰æ¨èäººæ—¶:                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚  åˆ›ä½œè€…     â”‚  â”‚   æ¨èäºº    â”‚  â”‚   å¹³å°      â”‚    â”‚
â”‚   â”‚   85%      â”‚  â”‚    10%     â”‚  â”‚    5%      â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â”‚   æ— æ¨èäººæ—¶:                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚  åˆ›ä½œè€…     â”‚                  â”‚   å¹³å°      â”‚     â”‚
â”‚   â”‚   95%      â”‚                  â”‚    5%      â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## åŠ¨æ€å®šä»·ç®—æ³•

### å…¬å¼

```
å½“å‰ä»·æ ¼ = åŸºç¡€ä»·æ ¼ Ã— (1.10)^n

å…¶ä¸­: n = floor(è§£é”æ¬¡æ•° / 10)
```

### å‚æ•°

| å‚æ•° | å€¼ | è¯´æ˜ |
|------|------|------|
| `PRICE_INCREMENT_INTERVAL` | 10 | æ¯ 10 æ¬¡è§£é”è§¦å‘æ¶¨ä»· |
| `PRICE_INCREMENT_PERCENT` | 10 | æ¯æ¬¡æ¶¨ä»· 10% |

### ä»·æ ¼ç¤ºä¾‹ (åŸºç¡€ä»·æ ¼ 0.01 MON)

| è§£é”æ¬¡æ•° | æ¶¨ä»·æ¬¡æ•° (n) | ç´¯è®¡æ¶¨å¹… | å½“å‰ä»·æ ¼ |
|----------|--------------|----------|----------|
| 0-9 | 0 | 0% | 0.0100 MON |
| 10-19 | 1 | 10% | 0.0110 MON |
| 20-29 | 2 | 21% | 0.0121 MON |
| 30-39 | 3 | 33.1% | 0.0133 MON |
| 40-49 | 4 | 46.4% | 0.0146 MON |
| 50-59 | 5 | 61.1% | 0.0161 MON |
| 100+ | 10 | 159.4% | 0.0259 MON |

### å®ç°ä»£ç 

```solidity
function getPrice(uint256 contentId) public view returns (uint256) {
    Content storage content = contents[contentId];
    require(content.active, "Content not active");
    
    uint256 increments = content.unlockCount / PRICE_INCREMENT_INTERVAL;
    uint256 price = content.basePrice;
    
    // æ¯10æ¬¡è§£é”ï¼Œä»·æ ¼ä¸Šæ¶¨10%
    for (uint256 i = 0; i < increments; i++) {
        price = (price * (100 + PRICE_INCREMENT_PERCENT)) / 100;
    }
    
    return price;
}
```

---

## æ ¸å¿ƒå‡½æ•°

### 1. createContent - åˆ›å»ºå†…å®¹

```solidity
function createContent(
    uint256 basePrice,
    string calldata metadataURI
) external returns (uint256 contentId)
```

**æµç¨‹**:
1. éªŒè¯ `basePrice > 0`
2. éªŒè¯ `metadataURI` éç©º
3. åˆ†é…æ–°çš„ `contentId`
4. å­˜å‚¨ `Content` ç»“æ„ä½“
5. è§¦å‘ `ContentCreated` äº‹ä»¶

**äº‹ä»¶**:
```solidity
event ContentCreated(
    uint256 indexed contentId,
    address indexed creator,
    uint256 basePrice,
    string metadataURI
);
```

---

### 2. unlock - è§£é”å†…å®¹

```solidity
function unlock(
    uint256 contentId,
    address referrer
) external payable nonReentrant returns (uint256 tokenId)
```

**æµç¨‹**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     unlock() æ‰§è¡Œæµç¨‹                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. éªŒè¯å†…å®¹æ¿€æ´»çŠ¶æ€ (content.active == true)                    â”‚
â”‚  2. éªŒè¯ç”¨æˆ·æœªè§£é”è¿‡ (!hasUnlocked[contentId][msg.sender])       â”‚
â”‚  3. éªŒè¯æ¨èäººä¸æ˜¯è‡ªå·± (referrer != msg.sender)                  â”‚
â”‚  4. è®¡ç®—åŠ¨æ€ä»·æ ¼ getPrice(contentId)                             â”‚
â”‚  5. éªŒè¯æ”¯ä»˜é‡‘é¢å……è¶³ (msg.value >= currentPrice)                 â”‚
â”‚  6. æ ‡è®°å·²è§£é” hasUnlocked[contentId][msg.sender] = true        â”‚
â”‚  7. å¢åŠ è§£é”è®¡æ•° content.unlockCount++                           â”‚
â”‚  8. é“¸é€  NFT _safeMint(msg.sender, tokenId)                     â”‚
â”‚  9. è®¾ç½® NFT URI _setTokenURI(tokenId, metadataURI)             â”‚
â”‚  10. åˆ†é…æ”¶ç›Šåˆ°å„æ–¹ä½™é¢                                          â”‚
â”‚  11. è®°å½•è§£é”å†å² userUnlocks[msg.sender].push(...)              â”‚
â”‚  12. é€€è¿˜å¤šä½™æ”¯ä»˜ (å¦‚æœ msg.value > currentPrice)                â”‚
â”‚  13. è§¦å‘ ContentUnlocked äº‹ä»¶                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº‹ä»¶**:
```solidity
event ContentUnlocked(
    uint256 indexed contentId,
    address indexed user,
    uint256 indexed tokenId,
    uint256 paidPrice,
    address referrer
);
```

---

### 3. withdraw - æç°

```solidity
function withdraw() external nonReentrant
```

**æµç¨‹**:
1. è¯»å– `creatorBalance[msg.sender]` + `referrerBalance[msg.sender]`
2. éªŒè¯æ€»ä½™é¢ > 0
3. æ¸…é›¶ä½™é¢ (é˜²é‡å…¥)
4. è½¬è´¦ç»™è°ƒç”¨è€…
5. è§¦å‘ `Withdrawal` äº‹ä»¶

---

### 4. getPrice - è·å–åŠ¨æ€ä»·æ ¼

```solidity
function getPrice(uint256 contentId) public view returns (uint256)
```

**è¿”å›**: å½“å‰ä»·æ ¼ (wei)

---

### 5. checkAccess - æ£€æŸ¥è®¿é—®æƒé™

```solidity
function checkAccess(uint256 contentId, address user) public view returns (bool)
```

**é€»è¾‘**:
- å¦‚æœç”¨æˆ·ç›´æ¥è§£é”è¿‡ â†’ `true`
- å¦‚æœç”¨æˆ·æŒæœ‰è¯¥å†…å®¹å¯¹åº”çš„ NFT â†’ `true`
- å¦åˆ™ â†’ `false`

---

## å®‰å…¨æœºåˆ¶

| æœºåˆ¶ | å®ç° | é˜²æŠ¤ |
|------|------|------|
| **é˜²é‡å…¥** | `ReentrancyGuard` | é˜²æ­¢é‡å…¥æ”»å‡» |
| **æ‰€æœ‰æƒ** | `Ownable` | å¹³å°æç°æƒé™æ§åˆ¶ |
| **æ£€æŸ¥-ç”Ÿæ•ˆ-äº¤äº’** | çŠ¶æ€å…ˆä¿®æ”¹åè½¬è´¦ | é˜²æ­¢é‡å…¥ |
| **ä½™é¢éªŒè¯** | `require(total > 0)` | é˜²æ­¢ç©ºæç° |

---

# ğŸ–¥ï¸ åç«¯æ¶æ„ (NestJS)

## ç›®å½•ç»“æ„

```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.ts                    # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ app.module.ts              # æ ¹æ¨¡å—
â”‚   â”‚
â”‚   â”œâ”€â”€ content/                   # ğŸ“ å†…å®¹æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ content.module.ts      # æ¨¡å—å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ content.controller.ts  # è·¯ç”±æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ content.service.ts     # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ dto/
â”‚   â”‚       â””â”€â”€ create-content.dto.ts  # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚
â”‚   â”œâ”€â”€ payment/                   # ğŸ“ æ”¯ä»˜æ¨¡å— (x402)
â”‚   â”‚   â”œâ”€â”€ payment.module.ts      # æ¨¡å—å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ payment.controller.ts  # è·¯ç”±æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ payment.service.ts     # x402 é›†æˆ
â”‚   â”‚
â”‚   â””â”€â”€ user/                      # ğŸ“ ç”¨æˆ·æ¨¡å—
â”‚       â”œâ”€â”€ user.module.ts         # æ¨¡å—å®šä¹‰
â”‚       â”œâ”€â”€ user.controller.ts     # è·¯ç”±æ§åˆ¶å™¨
â”‚       â””â”€â”€ user.service.ts        # ä¸šåŠ¡é€»è¾‘
â”‚
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ nest-cli.json
```

---

## æ¨¡å—ä¾èµ–å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     AppModule                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚   â”‚ ContentModule â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚   â”‚               â”‚              â”‚ imports              â”‚
â”‚   â”‚ - Controller  â”‚              â–¼                      â”‚
â”‚   â”‚ - Service     â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ PaymentModule â”‚              â”‚
â”‚                          â”‚               â”‚              â”‚
â”‚                          â”‚ - Controller  â”‚              â”‚
â”‚                          â”‚ - Service     â”‚              â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚   â”‚  UserModule   â”‚                                     â”‚
â”‚   â”‚               â”‚                                     â”‚
â”‚   â”‚ - Controller  â”‚                                     â”‚
â”‚   â”‚ - Service     â”‚                                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## API ç«¯ç‚¹

### Content Module

| æ–¹æ³• | ç«¯ç‚¹ | æè¿° | è®¤è¯ |
|------|------|------|------|
| `GET` | `/api/content` | è·å–å†…å®¹åˆ—è¡¨ | æ—  |
| `GET` | `/api/content/:id/preview` | è·å–å†…å®¹é¢„è§ˆ | æ—  |
| `GET` | `/api/content/:id` | è·å–å®Œæ•´å†…å®¹ | x402 æ”¯ä»˜ |
| `POST` | `/api/content` | åˆ›å»ºæ–°å†…å®¹ | é’±åŒ…åœ°å€ |
| `GET` | `/api/content/meta/categories` | è·å–åˆ†ç±»åˆ—è¡¨ | æ—  |

#### GET /api/content

è·å–å†…å®¹åˆ—è¡¨ï¼ˆä¸å«å®Œæ•´å†…å®¹ï¼‰

**Query å‚æ•°**:
| å‚æ•° | ç±»å‹ | æè¿° |
|------|------|------|
| `category` | string | æŒ‰åˆ†ç±»ç­›é€‰ |
| `search` | string | æœç´¢å…³é”®è¯ |

**å“åº”**: `Content[]`

---

#### GET /api/content/:id

è·å–å®Œæ•´å†…å®¹ï¼ˆéœ€ x402 æ”¯ä»˜ï¼‰

**Headers**:
| åç§° | ç±»å‹ | å¿…å¡« | æè¿° |
|------|------|------|------|
| `x-payment` | string | æ˜¯ | x402 æ”¯ä»˜æ•°æ® |
| `x-wallet-address` | string | æ˜¯ | ç”¨æˆ·é’±åŒ…åœ°å€ |

**æˆåŠŸå“åº”** (200):
```json
{
  "id": "uuid",
  "title": "...",
  "fullContent": "å®Œæ•´å†…å®¹...",
  "unlocked": true,
  "transactionHash": "0x..."
}
```

**å¤±è´¥å“åº”** (402 Payment Required):
```json
{
  "statusCode": 402,
  "message": "Payment required to access this content",
  "price": "10000000000000000",
  "priceUsd": "$0.10",
  "contentId": 1,
  "payTo": "0x..."
}
```

---

### Payment Module

| æ–¹æ³• | ç«¯ç‚¹ | æè¿° |
|------|------|------|
| `GET` | `/api/payment/status` | è·å–æ”¯ä»˜æœåŠ¡çŠ¶æ€ |
| `GET` | `/api/payment/config` | è·å–æ”¯ä»˜é…ç½® |
| `POST` | `/api/payment/verify` | éªŒè¯æ”¯ä»˜ï¼ˆæµ‹è¯•ç”¨ï¼‰ |

#### GET /api/payment/config

**å“åº”**:
```json
{
  "network": {
    "name": "Monad Testnet",
    "chainId": 10143,
    "rpcUrl": "https://testnet-rpc.monad.xyz",
    "currency": {
      "name": "Monad",
      "symbol": "MON",
      "decimals": 18
    }
  },
  "facilitator": {
    "enabled": true,
    "recipient": "0x..."
  },
  "thirdweb": {
    "clientId": "..."
  }
}
```

---

### User Module

| æ–¹æ³• | ç«¯ç‚¹ | æè¿° |
|------|------|------|
| `GET` | `/api/user/unlocked` | è·å–å·²è§£é”å†…å®¹ |
| `GET` | `/api/user/stats` | è·å–ç”¨æˆ·ç»Ÿè®¡ |
| `GET` | `/api/user/profile` | è·å–ç”¨æˆ·èµ„æ–™ |

---

## æ•°æ®æ¨¡å‹

### Content

```typescript
interface Content {
  id: string;              // UUID (åç«¯ç”Ÿæˆ)
  contentId: number;       // é“¾ä¸Š Content ID
  title: string;           // æ ‡é¢˜
  description: string;     // æè¿°
  category: string;        // åˆ†ç±»
  preview: string;         // å…è´¹é¢„è§ˆå†…å®¹
  fullContent: string;     // ä»˜è´¹å®Œæ•´å†…å®¹
  basePrice: string;       // åŸºç¡€ä»·æ ¼ (wei)
  currentPrice: string;    // å½“å‰ä»·æ ¼ (åŠ¨æ€è®¡ç®—)
  priceUsd: string;        // USD æ˜¾ç¤ºä»·æ ¼
  creator: string;         // åˆ›ä½œè€…é’±åŒ…åœ°å€
  creatorName: string;     // åˆ›ä½œè€…åç§°
  metadataURI: string;     // å…ƒæ•°æ® URI
  unlockCount: number;     // è§£é”æ¬¡æ•°
  createdAt: Date;         // åˆ›å»ºæ—¶é—´
  tags: string[];          // æ ‡ç­¾æ•°ç»„
  imageUrl?: string;       // å°é¢å›¾ç‰‡ URL
}
```

### UnlockRecord

```typescript
interface UnlockRecord {
  contentId: string;       // å†…å®¹ ID
  transactionHash: string; // äº¤æ˜“å“ˆå¸Œ
  price: string;           // æ”¯ä»˜ä»·æ ¼
  referrer?: string;       // æ¨èäººåœ°å€
  unlockedAt: Date;        // è§£é”æ—¶é—´
}
```

### UserProfile

```typescript
interface UserProfile {
  address: string;                    // é’±åŒ…åœ°å€
  unlockedContents: UnlockRecord[];   // è§£é”è®°å½•
  createdContents: string[];          // åˆ›å»ºçš„å†…å®¹ ID
  totalSpent: string;                 // æ€»æ”¯å‡º (wei)
  totalEarned: string;                // æ€»æ”¶å…¥ (wei)
  referralEarnings: string;           // æ¨èæ”¶ç›Š (wei)
}
```

---

## x402 æ”¯ä»˜é›†æˆ

### PaymentService æ ¸å¿ƒæ–¹æ³•

```typescript
class PaymentService {
  // Thirdweb å®¢æˆ·ç«¯
  private client: ThirdwebClient;
  
  // Monad Testnet é…ç½®
  private monadTestnet = defineChain(10143);
  
  // x402 Facilitator
  private twFacilitator: Facilitator;

  /**
   * éªŒè¯å¹¶ç»“ç®— x402 æ”¯ä»˜
   */
  async verifyPayment(params: VerifyPaymentParams): Promise<PaymentVerificationResult> {
    // 1. è°ƒç”¨ Thirdweb settlePayment
    const result = await settlePayment({
      resourceUrl: params.resourceUrl,
      method: 'GET',
      paymentData: params.paymentData,
      network: this.monadTestnet,
      price: this.weiToUsd(params.expectedAmount),
      payTo: process.env.RECIPIENT_WALLET,
      facilitator: this.twFacilitator,
    });

    // 2. è¿”å›éªŒè¯ç»“æœ
    if (result.status === 200) {
      return {
        success: true,
        transactionHash: result.paymentReceipt?.transaction,
      };
    }
    
    return { success: false, error: '...' };
  }
}
```

---

## x402 æ”¯ä»˜æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         x402 æ”¯ä»˜æµç¨‹                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  1ï¸âƒ£ ç”¨æˆ·è¯·æ±‚å†…å®¹ (æ— æ”¯ä»˜æ•°æ®)                                           â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚     â”‚  å‰ç«¯    â”‚ â”€â”€GET /content/:idâ”€â”€â–ºâ”‚  åç«¯    â”‚                      â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                              â”‚                          â”‚
â”‚  2ï¸âƒ£ åç«¯è¿”å› 402 Payment Required                                       â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚     â”‚  å‰ç«¯    â”‚ â—„â”€â”€ 402 + ä»·æ ¼ä¿¡æ¯ â”€â”€â”€â”‚  åç«¯    â”‚                      â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚          â”‚                                                              â”‚
â”‚  3ï¸âƒ£ å‰ç«¯è°ƒç”¨é’±åŒ…ç­¾å                                                     â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚     â”‚  å‰ç«¯    â”‚ â”€â”€â”€â”€â”€ ç­¾åè¯·æ±‚ â”€â”€â”€â”€â”€â”€â–ºâ”‚ MetaMask â”‚                      â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚          â”‚                                   â”‚                          â”‚
â”‚          â”‚â—„â”€â”€â”€â”€â”€ ç­¾ååçš„æ”¯ä»˜æ•°æ® â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                          â”‚
â”‚          â”‚                                                              â”‚
â”‚  4ï¸âƒ£ å‰ç«¯å¸¦æ”¯ä»˜æ•°æ®é‡æ–°è¯·æ±‚                                               â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚     â”‚  å‰ç«¯    â”‚ â”€â”€GET /content/:idâ”€â”€â–ºâ”‚  åç«¯    â”‚                      â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  Header: x-payment   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                              â”‚                          â”‚
â”‚  5ï¸âƒ£ åç«¯è°ƒç”¨ Thirdweb éªŒè¯å¹¶ç»“ç®—                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚     â”‚  åç«¯    â”‚ â”€â”€â”€â”€ settlePayment â”€â”€â–ºâ”‚ Thirdweb â”‚                      â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚Facilitatorâ”‚                      â”‚
â”‚                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                              â”‚                          â”‚
â”‚  6ï¸âƒ£ Facilitator åœ¨ Monad é“¾ä¸Šç»“ç®—                                       â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚     â”‚ Thirdweb â”‚ â”€â”€â”€â”€â”€ é“¾ä¸Šäº¤æ˜“ â”€â”€â”€â”€â”€â”€â–ºâ”‚  Monad  â”‚                      â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                              â”‚                          â”‚
â”‚  7ï¸âƒ£ è¿”å›å®Œæ•´å†…å®¹ç»™ç”¨æˆ·                                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚     â”‚  å‰ç«¯    â”‚ â—„â”€â”€ 200 + å®Œæ•´å†…å®¹ â”€â”€â”€â”‚  åç«¯    â”‚                      â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ğŸ”„ å®Œæ•´äº¤äº’æµç¨‹

## ç”¨æˆ·è§£é”å†…å®¹æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å®Œæ•´äº¤äº’æ—¶åºå›¾                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  ç”¨æˆ·  â”‚        â”‚  å‰ç«¯  â”‚        â”‚  åç«¯  â”‚        â”‚  åˆçº¦  â”‚       â”‚
â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â”‚
â”‚      â”‚                 â”‚                 â”‚                 â”‚            â”‚
â”‚      â”‚  1. æµè§ˆå†…å®¹     â”‚                 â”‚                 â”‚            â”‚
â”‚      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚                 â”‚            â”‚
â”‚      â”‚                 â”‚  GET /content   â”‚                 â”‚            â”‚
â”‚      â”‚                 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚            â”‚
â”‚      â”‚                 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚            â”‚
â”‚      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ å†…å®¹åˆ—è¡¨        â”‚                 â”‚            â”‚
â”‚      â”‚                 â”‚                 â”‚                 â”‚            â”‚
â”‚      â”‚  2. ç‚¹å‡»è§£é”     â”‚                 â”‚                 â”‚            â”‚
â”‚      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚                 â”‚            â”‚
â”‚      â”‚                 â”‚  GET /content/1 â”‚                 â”‚            â”‚
â”‚      â”‚                 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚            â”‚
â”‚      â”‚                 â”‚â—„â”€â”€ 402 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚            â”‚
â”‚      â”‚                 â”‚                 â”‚                 â”‚            â”‚
â”‚      â”‚  3. é’±åŒ…ç­¾å     â”‚                 â”‚                 â”‚            â”‚
â”‚      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚                 â”‚            â”‚
â”‚      â”‚                 â”‚                 â”‚                 â”‚            â”‚
â”‚      â”‚                 â”‚  4. å¸¦æ”¯ä»˜æ•°æ®   â”‚                 â”‚            â”‚
â”‚      â”‚                 â”‚  GET /content/1 â”‚                 â”‚            â”‚
â”‚      â”‚                 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                 â”‚            â”‚
â”‚      â”‚                 â”‚                 â”‚  5. éªŒè¯æ”¯ä»˜    â”‚            â”‚
â”‚      â”‚                 â”‚                 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚            â”‚
â”‚      â”‚                 â”‚                 â”‚                 â”‚  unlock()  â”‚
â”‚      â”‚                 â”‚                 â”‚                 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
â”‚      â”‚                 â”‚                 â”‚                 â”‚  é“¸é€ NFT   â”‚
â”‚      â”‚                 â”‚                 â”‚                 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚      â”‚                 â”‚                 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚            â”‚
â”‚      â”‚                 â”‚â—„â”€â”€ 200 + å†…å®¹ â”€â”€â”‚                 â”‚            â”‚
â”‚      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚                 â”‚            â”‚
â”‚      â”‚                 â”‚                 â”‚                 â”‚            â”‚
â”‚      â”‚  6. å†…å®¹å·²è§£é”   â”‚                 â”‚                 â”‚            â”‚
â”‚      â”‚     NFT å·²é“¸é€    â”‚                 â”‚                 â”‚            â”‚
â”‚      â”‚                 â”‚                 â”‚                 â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ğŸ“¦ éƒ¨ç½²æŒ‡å—

## ç¯å¢ƒå˜é‡é…ç½®

```bash
# .env æ–‡ä»¶

# Thirdweb é…ç½® (ä» https://thirdweb.com/dashboard è·å–)
THIRDWEB_SECRET_KEY=your_secret_key
THIRDWEB_CLIENT_ID=your_client_id

# é’±åŒ…é…ç½®
RECIPIENT_WALLET=0xYourWalletAddress
PRIVATE_KEY=0xYourPrivateKey

# Monad Testnet
MONAD_RPC_URL=https://testnet-rpc.monad.xyz
MONAD_CHAIN_ID=10143

# åç«¯é…ç½®
PORT=3001
BACKEND_URL=http://localhost:3001
FRONTEND_URL=http://localhost:5173

# åˆçº¦åœ°å€ (éƒ¨ç½²åå¡«å†™)
CONTRACT_ADDRESS=
```

## éƒ¨ç½²æ­¥éª¤

### 1. å®‰è£…ä¾èµ–

```bash
# æ ¹ç›®å½•
pnpm install

# å„å­é¡¹ç›®
cd backend && pnpm install
cd ../frontend && pnpm install
cd ../contracts && pnpm install
```

### 2. ç¼–è¯‘åˆçº¦

```bash
cd contracts
npx hardhat compile
```

### 3. è¿è¡Œæµ‹è¯•

```bash
npx hardhat test
```

### 4. éƒ¨ç½²åˆ° Monad Testnet

```bash
npx hardhat run scripts/deploy.ts --network monadTestnet
```

### 5. å¯åŠ¨æœåŠ¡

```bash
# åç«¯
cd backend && pnpm start:dev

# å‰ç«¯
cd frontend && pnpm dev
```

---

# ğŸ”’ å®‰å…¨è€ƒè™‘

## æ™ºèƒ½åˆçº¦å®‰å…¨

| é£é™© | é˜²æŠ¤æªæ–½ |
|------|---------|
| é‡å…¥æ”»å‡» | `ReentrancyGuard` + æ£€æŸ¥-ç”Ÿæ•ˆ-äº¤äº’æ¨¡å¼ |
| æ•´æ•°æº¢å‡º | Solidity 0.8+ å†…ç½®æ£€æŸ¥ |
| æƒé™æ§åˆ¶ | `Ownable` + åˆ›ä½œè€…éªŒè¯ |
| å‰ç«¯ä¼ªé€  | é“¾ä¸ŠéªŒè¯æ‰€æœ‰å…³é”®æ“ä½œ |

## åç«¯å®‰å…¨

| é£é™© | é˜²æŠ¤æªæ–½ |
|------|---------|
| CORS | é…ç½®å…è®¸çš„æº |
| è¾“å…¥éªŒè¯ | `class-validator` DTO éªŒè¯ |
| æ”¯ä»˜ä¼ªé€  | Thirdweb Facilitator éªŒè¯ |
| ç¯å¢ƒå˜é‡ | æ•æ„Ÿä¿¡æ¯ä¸æäº¤åˆ°ä»£ç åº“ |

---

# ğŸ“„ License

MIT License

---

*æ–‡æ¡£æœ€åæ›´æ–°: 2024*

